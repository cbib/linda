<!--{{diagnostic}}-->

<!-- <div class="overlay" *ngIf="show_spinner">
    <div class="spinner-wrapper">

      <mat-progress-spinner mode="indeterminate"></mat-progress-spinner> 

    </div>
</div> -->
<!-- <div class="loaded-content" [class.blurred]="showSpinner"></div> 
</div> -->

<div style="overflow: auto"
    joyrideStep="StepDemoForm"
    title=""
    [stepContent]="democontent"
    [stepContentParams]="{'model_n':model_type, 'model_len':cleaned_model.length, 'model_level':level, 'message':get_message_guided_tour()}"
    (next)= "on_Next()">
    <div class="border-head"><h3><a href="index.html" class="logo"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span></b></a></h3></div>
    <div 
        class="btn-group"
        style="width: 100%;float: right;"
        joyrideStep="StepMenuForm"
        title=""
        [stepContent]="menucontent"
        [stepContentParams]="{'model_n':model_type, 'model_len':cleaned_model.length, 'model_level':level, 'message':get_message_guided_tour()}">
        <button (click)="onClickTour(true)" style="float: right;" class="btn btn-light">Help</button>
        <button *ngIf="level<max_level" style="float: right;" class="btn btn-info" (click)="goToNext(modelForm,level)">Next</button>
        <!-- <span style="margin-right:10px;"></span>-->

        <button 
        joyrideStep="StepSubmit"
        title=""
        [stepContent]="submitcontent"
        [stepPosition]="left"
        [stepContentParams]="{'model_n':model_type}"
        class="btn btn-success" style="float: right;" type="submit" (click)="submit(modelForm);" [disabled]="!modelForm.valid || ((get_startfilling()===false && mode==='create'))">Submit</button>
        <!-- </div> -->
        <ng-template #submitcontent let-nod="model_n">
            <div>
              <nav class="navbar navbar-expand-sm navbar-dark">
                  <h3>
                       <a class="logo" style="color: black;"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span> </b><span style="color: black;"> : THE TUTORIAL</span></a>
                  </h3>
              </nav>
            </div>
            <h2>Data submission</h2>
            <mat-card>
            <div *ngIf="help_mode">
                <p> Feel free to complete the form !  <br>
                When it's done, click on <button class="btn btn-success">Submit</button> to submit your form !! </p>
            </div>
            <div *ngIf="!help_mode">
                <p>As you can see, your form has been filled with the corresponding values ! Feel free to complete the form ! 
                    You can also save this form as template for further reuses ! <br>
                    When it's done, click on <button class="btn btn-success">Submit</button> to submit your form !! </p>
            </div>
        </mat-card>
            
            
        </ng-template>
        <!-- <span style="margin-right:10px;"></span> -->
        <button (click)="cancel(modelForm)" style="float: right;" class="btn btn-danger">Cancel</button>
        <!-- <span style="margin-right:10px;"></span> -->
        <button *ngIf="level>1" style="float: right;" class="btn btn-xs btn-info" (click)="back(modelForm,level)" [disabled]="level<=1">Back</button>
        <!-- <span style="margin-right:10px;"></span> -->
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" [checked]="Checked" (change)="toggleVisibility($event)" id="flexSwitchCheckDefault">
            <label class="form-check-label" for="flexSwitchCheckDefault">Save as template</label>
        </div>
                    
        <!-- <label class="switch ">
            <input type="checkbox" [checked]="Checked" (change)="toggleVisibility($event)" class="default">
            <span class="slider round"></span>
        </label> -->
    </div>
    <ng-template style="min-height: 800px;max-height: 800px;" #menucontent let-nod="model_n" let-modellen="model_len" let-modell="model_level">
        <div>
          <nav class="navbar navbar-expand-sm navbar-dark">
              <h3>
                   <a class="logo" style="color: black;"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span></b><span style="color: black;"> : THE TUTORIAL</span></a>
              </h3>
          </nav>
        </div>
        <div>
            <div *ngIf="nod==='investigation'">
                <h2>Investigation Form</h2>
                <mat-card class="menu_mat_card">
                <h5>Definition</h5>
                <p><b>Investigation</b> is the entry point of each MIAPPE dataset. It contains several general metadata fields 
                    (e.g. title, description, submission/publication dates), including some critical for FAIRness 
                    (unique identifier, licence, MIAPPE version). One or more publications may be associated with the investigation. </p>
                </mat-card>
            </div>
            <div *ngIf="nod==='study'">
                <h2>Studies</h2>
                <mat-card  class="menu_mat_card">
                <h5>Definition</h5>
                <p><b>Study</b> corresponds to one experiment and defines its location (which by definition must be single per study) 
                    and duration. It lists general fields documenting the experiment (e.g. experimental design, cultural practices, 
                    growth facility). Like the investigation, it contains a unique identifier field. An investigation must have one or more studies.  </p>
                </mat-card>
            </div>
            
            <div *ngIf="nod==='experimental_factor'">
                <h2>Experimental factors</h2>
                <mat-card  class="menu_mat_card">
                    <h5>Definition</h5>
                    <p>
                        An <b>Experimental factor</b>  is, by definition a condition that varies between observation units, which may be biotic (pest, disease interaction) or abiotic (treatment and cultural practice) in nature. 
                        Depending on the level of the data, an experimental factor can be either  \"what is the factor applied to the plant\" (i.e. Unwatered), or the \"environmental characterisation\" (i.e. if no rain on unwatered plant : Drought ;  if rain on unwatered plant: Irrigated).
                        The object of a study is to ascertain the impact of one or more factors on the biological material.
                    </p>
                </mat-card>
            </div>
            <div *ngIf="nod==='observed_variable'">
                <h2>Observed variables</h2>
                <mat-card class="menu_mat_card">
                    <h5>Definition</h5>
                    <p> An <b>Observed variable</b> describes how a measurement has been made. It typically takes the form of a measured characteristic of the observation unit (plant or environmental trait), associated to the method and unit of measurement. </p>
                </mat-card>
            </div>
            <div *ngIf="nod==='biological_material'">
                <h2>Biological_materials</h2>
                <mat-card  class="menu_mat_card">
                    <h5>Definition</h5>
                    <p><b>Biological_material</b>  </p>
                </mat-card>
            </div>
            <div *ngIf="nod==='observation_unit'">
                <h2>Observation units</h2>
                <mat-card  class="menu_mat_card">
                    <h5>Definition</h5>
                    <p><b>Observation units</b>  </p>
                </mat-card>
            </div>
            
            <mat-card  class="menu_mat_card">
            <h5>Available actions</h5>
            <p>The highlighted menu allows you to navigate through form pages (Not all forms have multiple pages !! ).</p>
            <ul style="margin-bottom: 0px;">
            <div *ngIf="nod==='study'">
        
            <li style="margin-bottom: 0px;max-height: 40px;"><p>Click on <button class="btn btn-info" >Back</button> if you want to go back in previous form page</p></li>
            
            </div>
            <div *ngIf="nod==='observed_variable'">
                
                <li style="margin-bottom: 0px;"><p>Click on <button class="btn btn-info" >Back</button> if you want to go back in previous form page</p></li>
                
            </div>
            
           
                <li style="margin-bottom: 0px;"><p>Click on <button class="btn btn-danger" >Cancel</button> if you want to cancel the current form</p></li>
                <li style="margin-bottom: 0px;"><p>Click on <button class="btn btn-success" >Submit</button> when you have completed the form</p></li>
                <li style="margin-bottom: 0px;"><p>Click on <button class="btn btn-light" >Help</button> to replay tutorial for this form</p></li>
            
            <div *ngIf="nod==='study'">
                
                <li style="margin-bottom: 0px;"><p>Click on <button class="btn btn-info" >Next</button> if you want to go to next form page</p></li>
                
            </div>
            <div *ngIf="nod==='observed_variable'">
                
                <li  style="margin-bottom: 0px;"><p>Click on <button class="btn btn-info" >Next</button> if you want to go to next form page</p></li>
                
            </div>
            </ul>
            <ul>
                <li  style="margin-bottom: 0px;" ><p><input class="form-check-input" type="checkbox" id="checkbox_example">
                <label class="form-check-label" for="checkbox_example">Save as template</label> checkbox on the left will save your form as a template form, available for furthers reuses</p></li>
            </ul>
            </mat-card>
            
            <div *ngIf="nod==='experimental_factor'">
                <mat-card  class="menu_mat_card">
                <h5>Available ontologies</h5>
                <ul>
                    <li style="margin-bottom: 8px;max-height: 50px;"><p><b>EFO </b>:  The Experimental Factor Ontology (EFO) provides a systematic description of many experimental variables available in EBI databases, and for projects such as the GWAS catalog.</p> </li>
                    <li><p><b>PECO </b>: A structured, controlled vocabulary which describes the treatments, growing conditions, and/or study types used in plant biology experiments.</p></li>
                </ul>
            </mat-card>
            </div>
            
        </div> 
      </ng-template>

    <div 
    
        >
        <!-- joyrideStep="Step1_2" 
        title="Here is the form to complete" 
        text="Form can be one or more page. " -->
    <h1 style="text-align: center">{{ model_type[0].toUpperCase() +  model_type.slice(1).replace("_"," ")}}</h1>
    <p>{{model.Definition}}</p>
    <!-- <div *ngIf="model_type!=='biological_material'"> -->
    <form [formGroup]="modelForm">
        <div 
        joyrideStep="StepContentForm"
        title=""
        [stepContent]="formcontent"
        [stepContentParams]="{'model_n':model_type, 'model_len':cleaned_model.length, 'model_level':level, 'message':get_message_guided_tour()}">
            <div class="form-group" *ngFor="let field of cleaned_model ; index as i;">
                <div *ngIf="model[field['key']].Level==level">
                    <label for="{{field['key']}}">{{field['key']}}</label>
                    <span style="display:inline-block; margin-left: 10px;">
                        <i style="color :lightblue" class="fa fa-info-circle"
                            title="{{model[field['key']].Definition}}"></i>
                    </span>
                    <!--ontology format =-->
                    <div 
                    *ngIf="model[field['key']].Format.includes('Ontology')"
                    joyrideStep="StepOntologyField"
                    title=""
                    [stepContent]="formOntologyContent"
                    [stepContentParams]="{'model_n':model_type, 'model_len':cleaned_model.length, 'model_level':level, 'message':get_message_guided_tour()}"
                    (done)= "onDone()">

                        <div *ngFor="let ont of model[field['key']]['Associated ontologies'] ; index as j;"
                            class="btn-group">
                            <button class="btn btn-success btn-xs fa fa-plus"
                                (click)="onOntologyTermSelection(ont, field['key'],model[field['key']].Multiple)">
                                {{ont}}
                            </button>

                        </div>
                        <span *ngIf="validated_term[field['key']].selected!==true"
                            style="display:inline-block; margin-left: 10px;">
                            <input style="color:black" mdbInput placeholder="{{model[field['key']].Example}}" type="text"
                                formControlName="{{field['key']}}" class="form-control" (keypress)="onTaskAdd($event)" />
                        </span>
                        <span *ngIf="validated_term[field['key']].selected===true"
                            style="display:inline-block; margin-left: 10px;">
                            <input style="color:black" mdbInput value="{{validated_term[field['key']].values}}" type="text"
                                formControlName="{{field['key']}}" class="form-control" (keypress)="onTaskAdd($event)"
                                [ngClass]="{ 'is-invalid': f[field['key']].errors }" />
                        </span>
                    </div>
                    <ng-template style="min-height: 800px;max-height: 800px;" #formOntologyContent let-nod="model_n" let-modellen="model_len" let-modell="model_level" let-modelmessage="message">
                        <div>
                          <nav class="navbar navbar-expand-sm navbar-dark">
                              <h3>
                                   <a class="logo" style="color: black;"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span></b><span style="color: black;"> : THE TUTORIAL</span></a>
                              </h3>
                          </nav>
                        </div>
                        <div *ngIf="nod==='study'">
                            <h2>studies</h2>
                            <mat-card>
                            <p>For study form, there are two field that you can fill using ontology trees</p>
                            <h5>Type of experimental design  (Ontology field example)</h5>
                                <p>
                                    Click on corresponding ontology button CO_715 or OBI to define your experimental design
                                </p>
                            </mat-card>
                            <mat-card>
                            <h5>Type of growth facility</h5>
                            <p>
                                Click on corresponding ontology button CO_715 or OBI to define your experimental design
                            </p>
                            </mat-card>
                                <mat-card>
                            <h6>Notes</h6>
                            <p> You can use the search box in the  top of the ontology tree to quickly find terms </p>
                            </mat-card>
                        </div>

                        <div *ngIf="nod==='experimental_factor'">

                            <h2>Experimental factors </h2>
                            <mat-card>
                            <h5>Ontology field (Ontology field)</h5>
                            <p>
                                Ontology term is required for this field. You can use tree at you disposal to explore the following ontologies
                            </p>
                            </mat-card>
                            <mat-card>
                            <h5>Experimental factor accession number</h5>
                            <p>
                                Click on corresponding ontology button EFO or PECO to define your experimental factor using ontology accession number
                            </p>
                            </mat-card>

                        </div>
                        <div *ngIf="nod==='observed_variable'">
                            <h2>Observed variables</h2>
                            <mat-card>
                                <h5>Ontology field (Ontology field)</h5>
                                <p>
                                    Ontology term is required for this field. You can use tree at you disposal to explore the following ontologies
                                </p>
                            </mat-card>
                            <mat-card>
                                <h5>Trait accession number</h5>
                                <p>
                                    Click on available ontologies (CO_322, CO_325, CO_331, XEO, Solanacae) to define trait accession number. 
                                    
                                </p>
                            </mat-card>
                            <mat-card>
                                <h6>Notes</h6>
                                <p> 
                                    You can use the search box in the  top of the ontology tree to quickly find terms 
                                </p>
                                <p>
                                    If selected ontology term contains definition, this definition will filled the Trait name field 
                                </p>
                            </mat-card>
                        </div>
                        
                    </ng-template>

                    <!--not a ontology format =-->
                    <div *ngIf="!model[field['key']].Format.includes('Ontology')">
                        <!--not a date format-->
                        <div *ngIf="!field['key'].includes('date')">
                            <!-- <input *ngIf="!model[field['key']].Format.includes('Free text') && mode==='edit'" mdbInput
                                [disabled]="model[field['key']].Format.includes('Unique identifier')" placeholder="{{model[field['key']].Example}}" type="text" formControlName="{{field['key']}}"
                                    class="form-control" (keypress)="onTaskAdd($event)"
                                    [ngClass]="{ 'is-invalid': f[field['key']].errors }" /> -->
                            <div *ngIf="model[field['key']].Format.includes('Unique identifier') && model[field['key']].Position === '1' "
                                    joyrideStep="StepMandatoryID"
                                    title=""
                                    [stepContent]="formUIcontent"
                                    [stepContentParams]="{'model_n':model_type, 'model_len':cleaned_model.length, 'model_level':level, 'message':get_message_guided_tour()}"
                                    (done)= "onDone()">
                                <input *ngIf="!model[field['key']].Format.includes('Free text') " mdbInput
                                    placeholder="{{model[field['key']].Example}}" type="text" formControlName="{{field['key']}}"
                                    class="form-control" (keypress)="onTaskAdd($event)"
                                    [ngClass]="{ 'is-invalid': f[field['key']].errors }" />
                                <textarea *ngIf="model[field['key']].Format.includes('Free text')" mdbInput
                                    placeholder="{{model[field['key']].Example}}" type="text" formControlName="{{field['key']}}"
                                    class="form-control" (keypress)="onTaskAdd($event)"
                                    [ngClass]="{ 'is-invalid': f[field['key']].errors}"></textarea>
                            </div>
                            <ng-template style="min-height: 800px;max-height: 800px;" #formUIcontent let-nod="model_n" let-modellen="model_len" let-modell="model_level" let-modelmessage="message">
                                <div>
                                  <nav class="navbar navbar-expand-sm navbar-dark">
                                      <h3>
                                           <a class="logo" style="color: black;"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span></b><span style="color: black;"> : THE TUTORIAL</span></a>
                                      </h3>
                                  </nav>
                                </div>
                                <div *ngIf="nod === 'investigation'">
                                    <h2>Investigation Form</h2>
                                </div>
                                <div *ngIf="nod === 'study'">
                                    <h2>Study Form</h2>
                                </div>
                                <mat-card>
                                    <h5>Unique identifier field</h5>
                                    <p> 
                                       This field requires a unique identifier !! <br>
                                    </p>
                                </mat-card>
                                
                                <div *ngIf="nod === 'investigation'">
                                <mat-card>
                                    <h5>Investigation Unique ID (Unique identifier)</h5>
                                    <p> 
                                        Identifier comprising the unique name of the institution/database hosting the submission of the 
                                        investigation data, and the accession number of the investigation in that institution. 
                                    </p>
                                </mat-card>
                                </div>
                                <div *ngIf="nod === 'study'">
                                    <mat-card>
                                        <h5>Study Unique ID (Unique identifier)</h5>
                                        <p> 
                                            Unique identifier comprising the name or identifier for the institution/database hosting 
                                            the submission of the study data, and the identifier of the study in that institution. 
                                        </p>
                                    </mat-card>
                                    </div>
                                
                                <mat-card>
                                <h6>Notes</h6>
                                <p> You must complete this kind of field in order to submit your form !! <br></p>
                                    <p>In addition, there may be more than one field requiring a unique identifier in a form !!</p>
                                </mat-card>
                                
                                <!-- <div *ngIf="nod === 'investigation'">
                                    <p> Let's add a new investigation!</p>
        
                                    <p> Add the following :</p>
                                        <ul>
                                        <li>  <p> Investigation unique ID : Maizes1</p></li>
                                        <li> <p> Short title: maizes1</p></li>
                                        </ul>
                                     <p> The other fields can be fullfilled later<br></p>
                                </div>
                                <div *ngIf="nod === 'study'">
                                    <p> Let's add a new study!</p>
                                    <p> Add the following on page 1 :</p>
                                        <ul>
                                        <li>  <p> Study unique Id: MaizeStudy1</p></li>
                                        <li> <p> Short title: Study1</p></li>
                                        <li> <p> Start date of study : 1/06/2021</p></li>
                                        <li> <p> End date of study : 30/06/2021</p></li>
                                        </ul>
                                    
                                    <p> Add the following on page 3 :</p>
                                    <ul>
                                    <li> <p> Type of experimental design: CO_715:0000145</p></li>
                                    <li> <p> Type of growth facility: CO_715:0000162</p></li>
                                    <li> <p> Observation unit level hierarchy : block &gt; rep &gt; plot</p></li>
                                    
                                    </ul>
                                  
                                </div> -->
                            </ng-template>

                            <div *ngIf="model[field['key']].Format.includes('Unique identifier') && model[field['key']].Position !== '1' "
>
                                <input *ngIf="!model[field['key']].Format.includes('Free text') " mdbInput
                                    placeholder="{{model[field['key']].Example}}" type="text" formControlName="{{field['key']}}"
                                    class="form-control" (keypress)="onTaskAdd($event)"
                                    [ngClass]="{ 'is-invalid': f[field['key']].errors }" />
                                <textarea *ngIf="model[field['key']].Format.includes('Free text')" mdbInput
                                    placeholder="{{model[field['key']].Example}}" type="text" formControlName="{{field['key']}}"
                                    class="form-control" (keypress)="onTaskAdd($event)"
                                    [ngClass]="{ 'is-invalid': f[field['key']].errors}"></textarea>
                            </div>


                            <div *ngIf="!model[field['key']].Format.includes('Unique identifier')"
                                    joyrideStep="StepNormalField"
                                    title=""
                                    [stepContent]="formNFcontent"
                                    [stepContentParams]="{'model_n':model_type}"
                                    (done)= "onDone()">
                                <input *ngIf="!model[field['key']].Format.includes('Free text') " mdbInput
                                    placeholder="{{model[field['key']].Example}}" type="text" formControlName="{{field['key']}}"
                                    class="form-control" (keypress)="onTaskAdd($event)"
                                    [ngClass]="{ 'is-invalid': f[field['key']].errors }" />
                                <textarea *ngIf="model[field['key']].Format.includes('Free text')" mdbInput
                                    placeholder="{{model[field['key']].Example}}" type="text" formControlName="{{field['key']}}"
                                    class="form-control" (keypress)="onTaskAdd($event)"
                                    [ngClass]="{ 'is-invalid': f[field['key']].errors}"></textarea>
                                <!-- <mat-slider formControlName="{{field['key']}}"
                                    *ngIf="!model[field['key']].Format.includes('Free text') && field['key'].includes('coordinates')"
                                    [displayWith]="formatLabel" step="0.01" thumbLabel min="0" max="1000" tickInterval="0.01">
                                </mat-slider>
                                <mat-slider formControlName="{{field['key']}}"
                                    *ngIf="!model[field['key']].Format.includes('Free text') && field['key'].includes('longitude')"
                                    [displayWith]="formatLongitudeLabel" step="0.01" thumbLabel min="-180" max="+180"
                                    tickInterval="0.01">
                                </mat-slider>
                                <mat-slider vertical #myMaterialLatitudeSlider formControlName="{{field['key']}}"
                                    *ngIf="!model[field['key']].Format.includes('Free text') && field['key'].includes('latitude')"
                                    [displayWith]="formatLatitudeLabel" step="0.01" thumbLabel min="-90" max="+90"
                                    tickInterval="0.01">
                                </mat-slider>
                                <mat-slider vertical formControlName="{{field['key']}}"
                                    *ngIf="!model[field['key']].Format.includes('Free text') && field['key'].includes('altitude')"
                                    [displayWith]="formatLabel" step="0.1" thumbLabel min="-11000" max="+11000"
                                    tickInterval="0.1">
                                </mat-slider> -->
                                
                            </div>
                            <ng-template style="min-height: 800px;max-height: 800px;" #formNFcontent let-nod="model_n">
                                <div>
                                  <nav class="navbar navbar-expand-sm navbar-dark">
                                      <h3>
                                           <a class="logo" style="color: black;"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span></b><span style="color: black;"> : THE TUTORIAL</span></a>
                                      </h3>
                                  </nav>
                                </div>
                                
                                <div *ngIf="nod === 'investigation'">
                                    <h2>Investigation Form</h2>
                                    <mat-card>
                                        <h5>Associated publication (free text field)</h5>
                                        <p> 
                                            An identifier for a literature publication where the investigation is described. Use of DOIs is recommended. 
                                        </p>
                                    </mat-card>    
                                </div>
                                <div *ngIf="nod === 'study'">
                                    <h2>Studies </h2>
                                    <mat-card>
                                
                                        <h5>Contact institution (Free text field)</h5>
                                        <p> 
                                            Name and adress of the institution responsible for the study 
                                        </p>
                                    </mat-card> 
                                </div>
                                    
                                <div *ngIf="nod === 'experimental_factor'">
                                    <h2>Experimental factors </h2>
                                    <mat-card>
                                    <h5>Experimental factor values (Formated text field)</h5>
                                    <p> List of possible values for the factor separated by ;</p>
                                    </mat-card> 
                                </div>
                                <div *ngIf="nod === 'observed_variable'">
                                    
                                    <h2>Observed variables</h2>
                                    <mat-card>
                                    <h5>Trait (Free text/Ontology field)</h5>
                                        <p> Name of the (plant or environmental) trait under observation </p>
                                    </mat-card>
                                    <mat-card>
                                        <h6>Notes</h6>
                                        <p>This field  will be automatically filled when selecting Trait accession number with ontology tree;</p>
                                    </mat-card>
                                </div>
                                
                            </ng-template>
                            


                            <div *ngIf="f[field['key']].errors" class="invalid-feedback">
                                <div style="color :red" *ngIf="f[field['key']].errors.required">{{field['key']}} is
                                    required</div>
                                <div style="color :red" *ngIf="f[field['key']].errors.minlength">minimum length is
                                    required</div>
                                <div style="color :red" *ngIf="f[field['key']].errors.create">Unique ID is required -
                                    already used !! </div>
                            </div>
                        </div>

                        <!--Date format-->
                        <div *ngIf="field['key'].includes('date')">
                            <input mdbInput placeholder="{{model[field['key']].Example}}" type="date"
                                formControlName="{{field['key']}}" class="form-control" (keypress)="onTaskAdd($event)" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- <ng-container *ngIf="level<2">
            <ng-container *ngTemplateOutlet="formcontent.studylevelone; context: guided_tour_messages.level1"></ng-container>
          </ng-container> -->
        <ng-template style="min-height: 800px;max-height: 800px;" #formcontent let-nod="model_n" let-modellen="model_len" let-modell="model_level" let-modelmessage="message">
            <div>
              <nav class="navbar navbar-expand-sm navbar-dark">
                  <h3>
                       <a class="logo" style="color: black;"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span></b><span style="color: black;"> : THE TUTORIAL</span></a>
                  </h3>
              </nav>
            </div>

            
            <div *ngIf="nod==='investigation'">
                <h2>Investigation Form</h2>
                <mat-card>
                <h5>Field description</h5>
                <p>
                    For each field, you have to described either manually or automatically using differents 
                    kind of widgets thats help you to capture your data. 
                </p>
                <p>
                    Some field are mandatory like some unique identifiers (submit button unabled) while others are optional and can be filled later.<br>
                    There are three main types of fields:
                </p>
                <ol>
                    <li><p>Free text or unique identifier fields</p></li>
                    <li><p>Ontology term selection field </p></li>
                    <li><p>Date or time range field</p></li>
                </ol>
                </mat-card>
                <mat-card>
                <h6>Notes</h6>
                <p>
                    These form must contain informations and details that describe your investigation (8 fields).
                </p>
                </mat-card>
            </div>
            <div *ngIf="nod==='study'">
                <h2>Studies</h2>
                <mat-card>
                <h5>Field description</h5>
                <p>
                    These form contains twenty fields to fullfill in order to capture informations and details from your study. <br> 
                    Like investigation, <b>Study identifier</b> requires to be <b>unique</b>. <br>
                    Let's see what a unique identifier field looks like.
                </p>
                </mat-card>
            
            </div>
            <div *ngIf="nod==='experimental_factor'">
                <h2>Experimental factors</h2>
                <mat-card>
                <h5>Field description</h5>
                <p>
                    These form contains four fields to fill out over two pages to describe your observed variable.. <br>
                    You can use ontologies at your disposal ( EFO and PECO) to fill some of the form fields; 
                </p>
                </mat-card>
            </div>
            <div *ngIf="nod==='observed_variable'">
                <h2>Observed variables</h2>
                <mat-card>
                <h5>Field description</h5>
                <p>
                    These form contains informations and details to describe your observed variable.<br> 
                    The observed variable form contains twelve fields to fill out over two pages. <br>
                    You can use available ontologies to easily fill this form; 
                </p>
                <p>
                    There are four important parts to fill to correctly describe an observed variable
                </p>
                <ol>
                    <li><p>The observed <b>trait</b></p></li>
                    <li><p>The observed <b>variable</b></p></li>
                    <li><p>The observation <b>method</b></p></li>
                    <li><p>the observation <b>scale</b></p></li>
                </ol>
                </mat-card>
            </div>
            
            
            
            <!-- <ng-template #studylevelone let-heading="heading" let-message="message">
                <div class="guided_tour_messages">
                    <h2>{{ get_message_guided_tour.heading }}</h2>
                    <p>{{ get_message_guided_tour.message }}</p>
                </div>
            </ng-template> -->

            <!-- <div *ngIf="get_form_model_type()===Study">
                Study model
            </div> -->
            <!-- <ng-template #primaryBlock>Primary text to show</ng-template>
            <ng-template let-mod="nod" [ngIf]="Study">
                you are in study form
                <div *ngIf="level===1">
                    At stage 1, you will see ontology form field for two important Study features
                </div>
                <div *ngIf="level===2">
                    At stage 2, you will see ontology form field for two important Study features
                </div>
                <div *ngIf="level===3">
                    At this stage you will see ontology form field for two important Study features
                    <img src="assets/images/ontology_widget_form.png" class="img-responsive" style="width:100%;height: auto; display: block;" alt="Image">
                </div>
            </ng-template> -->
          </ng-template>
    </form>
    </div>
    
    <!-- </div> -->
    <!-- <div *ngIf="model_type==='biological_material'">
        <form [formGroup]="modelForm">
            <div class="form-group" *ngFor="let field of cleaned_model ; index as i;">     
                <div *ngIf="model[field['key']].Level==1">
                    <label for="{{field['key']}}">{{field['key']}}</label>
                    <span style="display:inline-block; margin-left: 10px;">
                        <i style="color :lightblue" class="fa fa-info-circle"
                            title="{{model[field['key']].Definition}}"></i>
                    </span>
                    <div *ngIf="model[field['key']].Format.includes('Ontology')">
                        <div *ngFor="let ont of model[field['key']]['Associated ontologies'] ; index as j;"
                            class="btn-group">
                            <button class="btn btn-success btn-xs fa fa-plus"
                                (click)="onOntologyTermSelection(ont, field['key'],model[field['key']].Multiple)">
                                {{ont}}
                            </button>

                        </div>
                        <span *ngIf="validated_term[field['key']].selected!==true"
                            style="display:inline-block; margin-left: 10px;">
                            <input style="color:black" mdbInput placeholder="{{model[field['key']].Example}}"
                                type="text" formControlName="{{field['key']}}" class="form-control"
                                (keypress)="onTaskAdd($event)" />
                        </span>
                        <span *ngIf="validated_term[field['key']].selected===true"
                            style="display:inline-block; margin-left: 10px;">
                            <input style="color:black" mdbInput value="{{validated_term[field['key']].values}}"
                                type="text" formControlName="{{field['key']}}" class="form-control"
                                (keypress)="onTaskAdd($event)" [ngClass]="{ 'is-invalid': f[field['key']].errors }" />
                        </span>
                    </div>
                    <div *ngIf="!model[field['key']].Format.includes('Ontology')">
                        <div *ngIf="!field['key'].includes('date')">
                            <input *ngIf="!model[field['key']].Format.includes('Free text')" mdbInput
                                placeholder="{{model[field['key']].Example}}" type="text"
                                formControlName="{{field['key']}}" class="form-control" (keypress)="onTaskAdd($event)"
                                [ngClass]="{ 'is-invalid': f[field['key']].errors }" />
                            <textarea *ngIf="model[field['key']].Format.includes('Free text')" mdbInput
                                placeholder="{{model[field['key']].Example}}" type="text"
                                formControlName="{{field['key']}}" class="form-control" (keypress)="onTaskAdd($event)"
                                [ngClass]="{ 'is-invalid': f[field['key']].errors}"></textarea>
                            <div *ngIf="f[field['key']].errors" class="invalid-feedback">
                                <div style="color :red" *ngIf="f[field['key']].errors.required">{{field['key']}} is
                                    required</div>
                                <div style="color :red" *ngIf="f[field['key']].errors.minlength">minimum length is
                                    required</div>
                                <div style="color :red" *ngIf="f[field['key']].errors.create">Unique ID is required -
                                    already used !! </div>
                            </div>
                        </div>
                        <div *ngIf="field['key'].includes('date')">
                            <input mdbInput placeholder="{{model[field['key']].Example}}" type="date"
                                formControlName="{{field['key']}}" class="form-control"
                                (keypress)="onTaskAdd($event)" />
                        </div>
                    </div>
                </div>
            </div>

            <hr>
            
        </form>
    </div> -->
</div>
<ng-template style="min-height: 800px;max-height: 800px;" #democontent let-nod="model_n" let-modellen="model_len" let-modell="model_level" let-modelmessage="message">
    <div>
    <div>
      <nav class="navbar navbar-expand-sm navbar-dark">
          <h3>
               <a class="logo" style="color: black;"><b>P<span>L</span>ant exper<span>I</span>me<span>N</span>tal meta<span>D</span>at<span>A</span></b><span style="color: black;"> : THE TUTORIAL</span></a>
          </h3>
      </nav>
    </div>
    <div *ngIf="nod === 'investigation'">
        <h2>Investigation Form</h2>
        <mat-card>
        <h5> Add a new investigation!</h5>

        <p> Click on <b>NEXT</b> to fill a new form for an investigation short-called <b>maizes1</b> with the following values:</p>
            <ul>
            <li> <p> <b>Investigation unique ID </b> : Maizes1</p></li>
            <li> <p> <b>Short title </b> : maizes1 </p></li>
            </ul>
        </mat-card>
        <mat-card>
        <h6>Notes</h6>
         <p> The other fields can be fullfilled later<br></p>
        </mat-card>
    </div>
    <div *ngIf="nod === 'study'">
        <h2>Studies</h2>
        <mat-card>
        <h5> Add a new study!</h5>
        <p> Click on <b>NEXT</b>  to fill a new form for a study short-called <b>Study1</b> with the following values:</p>
            <ul>
            <li> <p style="font-size: 14px;"> <b>Study unique Id </b> : MaizeStudy1</p></li>
            <li> <p style="font-size: 14px;"> <b>Short title </b> : MaizeStudy1</p></li>
            <li> <p style="font-size: 14px;"> <b>Start date of study </b> : 1/06/2021</p></li>
            <li> <p style="font-size: 14px;"> <b>End date of study </b> : 30/06/2021</p></li>
            <li> <p style="font-size: 14px;"> <b>Type of experimental design </b> : CO_715:0000145 (Complete block design)</p></li>
            <li> <p style="font-size: 14px;"> <b>Type of growth facility </b> : CO_715:0000162 (Field environment condition) </p></li>
            <li> <p style="font-size: 14px;"> <b>Observation unit level hierarchy </b> : block &gt; rep &gt; plot</p></li>
            <li> <p style="font-size: 14px;"> <b>Description of growth facility</b> : field environement condition</p></li>
            <li> <p style="font-size: 14px;"> <b>Observation unit description</b> : Observation units consisted in individual plots themselves consisting of a row of 5 plants at a density of 1 plant per square meter</p></li>
            <li> <p style="font-size: 14px;"> <b>Experimental site name</b> : INRA, UE Diascope - Chemin de Mezouls - Domaine experimental de Melgueil - 34130 Mauguio - France</p></li>
            <li> <p style="font-size: 14px;"> <b>Study title</b> : 2021 evaluation of hydric stress for a panel of 5 maize line (B73, PH207, Oh43, W64A, EZ47) at the experimental station of Maugio (France).</p></li>
            <li> <p style="font-size: 14px;"> <b>Cultural practices</b> : Irrigation was applied according needs for one field and not applied for the other during the month of june to compare water stress.</p></li>

        </ul>
    </mat-card>
      
    </div>
    <div *ngIf="nod === 'experimental_factor'">
        <h2>Experimental factors</h2>
        <mat-card>
        <h5> Add a new experimental factor!</h5>
        <p> Click on <b>NEXT</b>  to fill a new form for an experimental factor of type <b>Watering</b> with the following values:</p>
            <ul>
            <li> <p> <b>Experimental Factor type </b>: Watering</p></li>
            <li> <p> <b>Experimental Factor values </b>: rainfed;watered</p></li>
            <li> <p> <b>Experimental Factor accession number </b> : EFO:0000470</p></li>
            </ul>
        </mat-card>
        
      
    </div>
    <div *ngIf="nod === 'observed_variable'">
        <h2>Observed variables</h2>
        <mat-card>
            <h5> Add a new observed variable!</h5>
            <p>
                Click on <b>NEXT</b>  to fill a new form for an observed variable called <b>Plant height</b> with the following values : <br>
            </p>
                <ul>
                    <li><p> <b>Variable ID </b> : PH_M_cm</p></li>
                    <li><p> <b>Trait </b> : Plant height</p></li>
                    <li><p> <b>Method </b> : PH - Measurement</p></li>
                    <li><p> <b>Scale </b> : cm</p></li>
                </ul>
        </mat-card>
                
      
    </div>
    </div>
</ng-template>