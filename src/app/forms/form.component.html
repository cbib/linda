<!--{{diagnostic}}-->
<alert></alert>
    <div>
        <h1 style="text-align: center">{{ model_type[0].toUpperCase() +  model_type.slice(1).replace("_"," ")}}</h1> 
        <p>{{model.Definition}}</p>
        <form [formGroup]="modelForm" >
            <div class="form-group" *ngFor="let key of dict_array ; index as i;">
                <div *ngIf="model[key['key']].Level==level">
                    <label for="{{key['key']}}">{{key['key']}}</label>
                    <span style="display:inline-block; margin-left: 10px;"> 
                        <i style="color :lightblue" class="fas fa-info-circle" title="{{model[key['key']].Definition}}"></i>
                    </span>  
                    <div *ngIf="model[key['key']].Format.includes('Ontology')">
                        <!--<input style="color:lightgrey"  mdbInput placeholder="{{model[key].Example}}" type="text" formControlName="{{key}}" class="form-control" (keypress)="onTaskAdd($event)" />--> 
                        <select name="nom" size="1" (change)="onSelect($event.target.value,key['key'])">
                            <option value="" disabled>Select Ontology</option>
                            <option value='XEO'>XEO</option>
                            <option value='EO'>EO</option>
                            <option value='EnvO'>EnvO</option>
                            <option value='PO_Structure'>PO Structure</option>
                            <option value='EFO'>EFO</option>
                            <option value='PO_Development'>PO Development</option>
                            <option value='CO_20'>Crop Ontology 20 </option>
                            <option value='CO_715'>Crop Ontology 715 </option>
                            </select> 
                        <span *ngIf="validated_term[key['key']].selected!==true" style="display:inline-block; margin-left: 10px;"> 
                            <input style="color:lightgrey"  mdbInput placeholder="{{model[key['key']].Example}}" type="text" formControlName="{{key['key']}}" class="form-control" (keypress)="onTaskAdd($event)" /> 
                        </span>
                            
                    <!--<input style="color:lightgrey"  mdbInput placeholder="{{model[key].Example}}" type="text" formControlName="{{key}}" class="form-control" (keypress)="onTaskAdd($event)" />--> 

                        <span *ngIf="validated_term[key['key']].selected===true" style="display:inline-block; margin-left: 10px;"> 
                            <input style="color:black"  mdbInput value="{{selected_term.id}}" type="text" formControlName="{{key['key']}}" class="form-control" (keypress)="onTaskAdd($event)" /> 
                        </span>
                    </div>
                    <div *ngIf="!model[key['key']].Format.includes('Ontology')"> 
                       <div *ngIf="!key['key'].includes('date')">
                        <input *ngIf="!model[key['key']].Format.includes('Free text')" mdbInput placeholder="{{model[key['key']].Example}}" type="text" formControlName="{{key['key']}}" class="form-control" (keypress)="onTaskAdd($event)" /> 
                            <textarea *ngIf="model[key['key']].Format.includes('Free text')" mdbInput placeholder="{{model[key['key']].Example}}" type="text" formControlName="{{key['key']}}" class="form-control" (keypress)="onTaskAdd($event)" ></textarea> 
                        </div>
                        <div *ngIf="key['key'].includes('date')">
                            <input mdbInput placeholder="{{model[key['key']].Example}}" type="date" formControlName="{{key['key']}}" class="form-control" (keypress)="onTaskAdd($event)" /> 
                        </div>
                    </div>

                    <div *ngIf="key['key'].includes('ID')">
                        <div *ngIf="submitted && f[key['key']].errors" class="invalid-feedback">
                            <div style="color :red" *ngIf="f[key['key']].errors.create ">Unique ID is required</div>
                            <div style="color :red" *ngIf="f[key['key']].errors.minLength ">Unique ID is required</div>
                        </div>
                    </div>
                    <!--to force date format-->
                    <!--<div *ngIf="submitted && f[key].errors && key.includes('date')" class="invalid-feedback">
                        <div style="color :red" *ngIf="f[key].errors.ptDate ">Date format ("dd/mm/yyyy") is required</div>
                    </div>-->
                    
                    <!--<div *ngIf="key.includes('Investigation unique ID')">
                        <div *ngIf="f[key].errors" class="invalid-feedback">
                            <pre>{{f[key].errors| json }}</pre>
                            <div style="color :red" *ngIf="f[key].errors.create ">Study Unique ID is required</div>
                        </div>
                    </div>
                    <pre>{{f[key].errors| json }}</pre>
                    <div *ngIf="f[key].errors && key.includes('date')" class="invalid-feedback">
                        <div style="color :red" *ngIf="f[key].errors.ptDate ">Date format ("dd/mm/yyyy") is required</div>
                        <pre>{{f[key].errors.ptDate| json }}</pre>
                    </div>-->
                    
                 </div>
            </div>
        </form>
        <div class="form-group text-center">

                <button class="btn btn-outline-rounded btn-info" (click)="back(modelForm,level)" [disabled]="level<=1" > 
                    <span style="margin-right:10px;" class="glyphicon glyphicon-arrow-left"></span> Back
                </button><span style="margin-right:10px;"></span>
                
                <button (click)="cancel(modelForm)" class="btn btn-outline-rounded btn-info"> 
                    <span style="margin-right:10px;"></span> Cancel
                </button><span style="margin-right:10px;"></span>

                <button *ngIf="level<max_level" class="btn btn-outline-rounded btn-info" (click)="goToNext(modelForm,level)"> Next 
                    <span style="margin-left:10px;" class="glyphicon glyphicon-arrow-right"></span>
                </button><span style="margin-right:10px;"></span>
                
                
                <button *ngIf="level==max_level" class="btn btn-outline-rounded btn-info" type="submit" [disabled]="!modelForm.valid || (get_startfilling()===false && mode==='create')" (click)="submit(modelForm)"> Submit
                    <span style="margin-left:10px;" class="glyphicon glyphicon-arrow-right"></span>
                </button><span style="margin-right:10px;"></span>
                
                
                <input type="checkbox" [disabled]="!get_startfilling()" (change)="toggleVisibility($event)" name="fancy-checkbox-info" id="fancy-checkbox-info" autocomplete="off" />
                
                <div class="[ btn-group ]">
                    <label for="fancy-checkbox-info" class="[ btn btn-info ]">
                        <span class="[ glyphicon glyphicon-ok ]"></span>
                        <span>Â </span>
                    </label>
                    <label for="fancy-checkbox-info" class="[ btn btn-default active ]">
                        Save as template
                    </label>
                </div>


        </div>
        <!--<pre>{{ modelForm.value | json }}</pre>-->
    </div>